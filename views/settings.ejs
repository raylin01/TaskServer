<!DOCTYPE html>
<html>
<head>
  <title>TaskServer - Settings</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <header>
    <h1>TaskServer</h1>
    <nav>
      <a href="/scripts">Scripts</a> |
      <a href="/add-script">Add Script</a> |
      <a href="/settings">Settings</a>
    </nav>
  </header>
  <main>
    <h2>⚙️ Settings</h2>
    
    <% if (typeof saved !== 'undefined' && saved) { %>
      <div class="alert alert-success">Settings saved successfully! Restart the server for changes to take effect.</div>
    <% } %>
    
    <form method="post" action="/settings" class="script-form">
      <h3>Log Management</h3>
      
      <div class="form-group">
        <div class="toggle-field">
          <label for="autoDelete">
            <strong>Automatic Log Deletion</strong>
            <small>Enable automatic deletion of old log files</small>
          </label>
          <label class="toggle-switch">
            <input type="checkbox" id="autoDelete" name="autoDelete" <%= logManagement.autoDelete ? 'checked' : '' %>>
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>

      <div class="form-group">
        <label for="retentionDays">
          Retention Period (Days)
          <span class="required">*</span>
        </label>
        <input type="number" id="retentionDays" name="retentionDays" min="1" max="365" 
               value="<%= logManagement.retentionDays %>" required>
        <small>Logs older than this many days will be automatically deleted</small>
      </div>

      <div class="form-group">
        <label for="checkInterval">
          Check Interval (Milliseconds)
          <span class="required">*</span>
        </label>
        <input type="number" id="checkInterval" name="checkInterval" min="60000" step="60000"
               value="<%= logManagement.checkInterval %>" required>
        <small>How often to check for old logs (default: 3600000ms = 1 hour)</small>
        <div class="interval-helpers">
          <button type="button" onclick="setInterval(3600000)">1 Hour</button>
          <button type="button" onclick="setInterval(21600000)">6 Hours</button>
          <button type="button" onclick="setInterval(86400000)">24 Hours</button>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-primary">Save Settings</button>
        <a href="/scripts" class="btn-secondary">Cancel</a>
      </div>
    </form>

    <div class="info-box">
      <h4>ℹ️ How Log Management Works</h4>
      <ul>
        <li><strong>Auto-delete:</strong> When enabled, TaskServer will automatically delete log files older than the retention period</li>
        <li><strong>Retention Days:</strong> Logs are kept for this many days before being deleted</li>
        <li><strong>Check Interval:</strong> How frequently the system checks for old logs to delete</li>
        <li><strong>Note:</strong> Changes require a server restart to take effect</li>
      </ul>
    </div>
  </main>
  <footer>
    <small>&copy; 2025 TaskServer</small>
  </footer>

  <script>
    function setInterval(ms) {
      document.getElementById('checkInterval').value = ms;
    }
  </script>
</body>
</html>
